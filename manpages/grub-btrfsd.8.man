.TH "grub-btrfsd" "8"

.SH "NAME"
.PP
grub-btrfsd - An OpenRC daemon to automatically update the grub menu with
.BR grub-btrfs (8)
.PP
when a new btrfs snapshot is created.

.SH "SYNOPSIS"
.PP
grub-btrfs-openrc <snapshot-path> <timeshift-auto>


.SH "DESCRIPTION"
.PP
Grub-btrfs-openrc is a shell script which is meant to be run as a daemon for openrc.
Grub-btrfsd watches a directory where a snapshot is created via inotifywait and runs grub-mkconfig (if grub-mkconfig never ran before since grub-btrfs was installed) or \fC/etc/grub.d/41_snapshots\-btrfs\fP (when grub-mkconfig ran before with grub-btrfs installed) when something in that directory changes.

.SH "OPTIONS"
.SS "\fCsnapshot\-path\fP"
.PP
This argument specifies the path where grub-btrfd looks for newly created snapshots and snapshot deletions. It is usually defined by the program used to make snapshots.
E.g. for Snapper this would be \fC/.snapshots\fP

.SS "\fCtimeshift\-auto\fP"
.PP
This is as boolean variable to activate the auto detection of the path where Timeshift stores snapshots. Newer versions of Timeshift mount their snapshots to \fC/run/timeshift/$PID/backup/timeshift\-btrfs\fP. Where \fC$PID\fP is the process ID of the currently running Timeshift session. The PID is changing every time Timeshift opened. grub-btrfsd can automatically take care of the detection of the correct PID and directory if this argument \fCtimeshift_auto\fP is set to true \fCtrue\fP. In this case the argument \fCsnapshots\fP has no influence.

.SH "CONFIGURATION"
.PP
The daemon is configured via the file \fC/etc/conf.d/grub\-btrfsd\fP. In this file the arguments (See OPTIONS) that OpenRC passes to the daemon when it is started can be configured.

.SS "NOTES"
.PP
A common configuration for Snapper would be to set \fCsnapshots\fP to \fC/.snapshots\fP and \fCtimeshift_auto\fP to \fCfalse\fP.
For Timeshift \fCtimeshift_auto\fP is set to true and \fCsnapshots\fP can be left as is.

.SH "FILES"
.PP
\fC/etc/conf.d/grub\-btrfsd\fP

.SH "SEE ALSO"
.IR btrfs (8)
.IR btrfs-subvolume (8)
.IR grub-btrfsd (8)
.IR grub-mkconfig (8)
.IR inotifywait (1)
.IR openrc (8)
.IR rc-service (8)
.IR timeshift (1)

.SH "COPYRIGHT"
.PP
Copyright (c) 2022 Pascal JÃ¤ger
